<%- include('partials/header') %>

<link rel="stylesheet" href="/styles/admin-link.css"/>

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js" defer>
</script>
<script> const results = <%- JSON.stringify(results) %>; </script>
<script defer src="/scripts/admin-link.js"></script>
</head>

<body>
<header class="logo">
  <div class="banner">
    <img src="/icons/logo-text.png" alt="logo" class="img-fluid">
  </div>
</header>

<div class="body-container ">
  <h2>Poll Details</h2>

  <div class="voter-link-container">
    <h3>Voter Url</h3>
    <div class="voter-link">
      <textarea class="link form-control" readonly><%= url %></textarea>
      <button class="btn btn-primary copy">
        <i class="fa-regular fa-clipboard"></i>
      </button>
    </div>
    <div class="copy-message"></div>
  </div>

  <div class="chart-container">
    <h3>Poll Results</h3>
    <canvas id="barChart"></canvas>
  </div>

  <div class="poll-detail-container">
    <h3>Vote Details</h3>
    <% for (const voteDetail of voteDetails) { %>
      <div class="poll-detail pt-2">
        <h4>
          <%= voteDetail['voter_name'] %>
          's Preference</h4>
        <div class="poll-selection">
          <% for (let x = 0; x < voteDetail['selected_options_titles'].length; x++) { %>
            <p><%= voteDetail['selected_options_titles'][x] %> received
              <span><%= voteDetail['scores'][x] %> points</span>
            </p>
          <% } %>
        </div>
        <p><%= voteDetail['comment']%></p>
      </div>
    <% } %>
  </div>

  <div>
    <button class="end-button">End the Poll</button>
  </div>


</div>


<%- include('partials/footer') %>
